<div class="modal-header">
    <button type="button" class="close"
            data-dismiss="modal" aria-hidden="true">
        &times;
    </button>
    <h4 class="modal-title" id="myModalLabel">
        新 增
    </h4>
</div>
<form class="form-horizontal" role="form" action="" method="post"  id="category_add" >
    <input  id="id" type="hidden" name="id" :value="detail.id" />
    <input  type="hidden" name="code" :value="detail.code" />
    <input type="hidden" name="status" value="1"/>
    <input type="hidden" name="parentCode"  id="parentCode"/>
    <div class="m-form-group">
        <label class="col-sm-3 control-label no-padding-right" >功能名称 </label>
        <div class="col-sm-2">
            <input type="text"  class="form-control" required="true" name="name"  :value="detail.name"/>
        </div>
        <label class="col-sm-2 control-label no-padding-right" >地址</label>
        <div class="col-sm-5">
            <input type="text"  class="form-control"  name="url"  :value="detail.url"/>
        </div>
    </div>
    <div class="m-form-group">
        <label class="col-sm-3 control-label no-padding-right" >备注 </label>
        <div class="col-sm-2">
            <input type="text"  class="form-control" name="remark"  :value="detail.remark"/>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default"
                data-dismiss="modal">关闭
        </button>
        <button type="submit" class="btn btn-primary" id="btnsubmit">
            提交
        </button>
    </div>
</form>
<script>

    var parentCode = $("#myModal-add-info").attr("data-parentCode");
    var code = $("#myModal-add-info").attr("data-code");//code为空,为添加
    if(parentCode!=""){
        $("#parentCode").val(parentCode);
    }

    var contentVM = new Vue({
        el: '#category_add',
        data: {
            detail: ''//记录详情信息
        },
        replace:false
    });
    if(code!=""){
        $("#myModalLabel").html("查看");
        do_get(server+"/bases//function/"+code,{},function(data){
            contentVM.detail = data.obj;
        });
    }
    //添加/修改
    $("#category_add").submit(function(){
        var url =server+"/bases/function";
        var id = $("#id").val();
        var data = $("#category_add").serialize();
        do_post(url,data,function(data){
            if(data.errorMsg!=undefined){
                alert(data.errorMsg);
                return
            }
            if(id==''){
                alert("保存成功");
            }else{
                alert("修改成功");
            }
            $('#myModal-add-info').modal('hide');
            $('#list').treegrid('reload');
            return;
        })
        return false;
    })
</script>